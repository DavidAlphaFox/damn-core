
all tx/sound tx/audiovisual/msg to player/etc can be moved to properties
e.g. item pickup separate sound

=> and require for every any entity tx/destroy-audiovisual ?
which is separate for each ?
like d2


(ns entity.destroy-audiovisual
  (:require [core.component :refer [defcomponent]]
            [api.entity :as entity]))

; => entity/destroy-effect
; effect with context entity or position
; => anything can happen if an entitiy gets destroyed
; e.g. spawn something, shoot projectiles, area effect, etc.

; so we need effects for a specific context
; e.g. target-entity/target-all only selectable those wich apply the context

; and each skill/effects needs a skill/target ?
; otherwise weird no los checks ???

; in general we want to trigger effects at different places different contexts
; e.g. item equip/uneqip effect

; entity move effect(at interval times)
; or after duration effect (damage over time, etc.)

; => wherever we are we want to call generic tx/effects

; even at a button in main menu tx/effect
; sound/animation/etc.

; whenever something happends , anything, we can trigger other prepared effects
; when does something happen ?
; find a more generic approach
; rule system ???

; => try to find even deeper the connections
; on hit effect in diablo
; on-what effect?
; what else all could be triggered?

; on modifier make something shine or whatever & sounds

; on armor trigger show the equipped armor over the entity shortly ...

; @ player-dead / or player-enter there are all hardcoded effects

(defcomponent :entity/destroy-audiovisual {}
  (entity/destroy [[_ audiovisuals-id] entity ctx]
    (println "Play audiovisuals: " audiovisuals-id)
    [[:tx.entity/audiovisual (:position @entity) audiovisuals-id]]))


; Projectile dies ways:
; * (and hit-entity (not piercing?))
; * hits-wall?
; * duration/maxrange finished


; * on hits wall is not even rendered ....
; isn't it audiovisual ????
; effect always rendered?

; maybe projectile-collision trigger @ body
; before even moved to that loc ?

; also enemies are attacking my projectile with bow !!
; its not a valid target for such effects ....

; why when shooting left wall we have LoS and right wall not ?
; =-> but its minor bug for now ...

; I DO see the first walls around ... so they are in lOs!

; => bug report....

; Problably we want a simple state-machine simple for proejctiles
; where on kill this is triggered
; so we can remove projectiles also / interact with them

; or we do it with destroy idk.
